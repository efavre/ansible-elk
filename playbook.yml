---
- hosts: elk
  tasks:
  - name: install jave openJdk 7 (jre)
    apt: name=openjdk-7-jre state=present update_cache=yes
    become: yes
    become_method: sudo
  - name: check java version
    shell: java -version
  - name: add elastic.co apt public key as sudo
    apt_key: url=https://packages.elastic.co/GPG-KEY-elasticsearch state=present
    become: yes
    become_method: sudo
  - name: add elastic.co apt repository as sudo
    apt_repository: repo='deb http://packages.elastic.co/elasticsearch/1.5/debian stable main' state=present update_cache=yes
    become: yes
    become_method: sudo
  - name: install elasticsearch as sudo
    apt: name=elasticsearch state=present update_cache=yes
    become: yes
    become_method: sudo
  - name: start elasticsearch service as sudo
    service: name=elasticsearch state=started
    become: yes
    become_method: sudo